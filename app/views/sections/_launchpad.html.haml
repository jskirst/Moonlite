%div.sectioninfocontainer
  %div.launchpadCRcolumn
    %div.launchpadcolumnheader
      %button#editor_link.button.button-small.button-info{ style: "margin-top: -5px; text-shadow:none;" } Create a Question
      %ul.nav.nav-tabs
        %li.active
          %a#arena_tab_link{ href: "#arena_tab", title: "Arena"} Arena
        %li
          %a#questions_tab_link{ href: "#questions_tab", title: "Creative Responses"}  Creative Response
        %li
          %a#achievement_tab_link{ href: "#achievements_tab", title: "Tasks"} Tasks      
      %div#arena_tab.tab_content{style:"margin-left:12px;"}
        %div.editor_view{ style: "display: none;" }
          %p Content creator
        %div.task_view
          - if @core_tasks.empty?
            %p No core tasks available.
          - elsif @core_tasks.select{ |t| t.status_id.nil? }.size > 0
            %p{ style: "margin: 15px 0 15px 0;" } Enter the Arena to see where you stack up!
            %p= link_to "Start", continue_section_path(@current_section), class: "button button-actionable"  
          - else
            - correct_tasks = @core_tasks.select{ |t| t.status_id.to_i == Answer::CORRECT }.size
            - incorrect_tasks = @core_tasks.select{ |t| t.status_id.to_i == Answer::INCORRECT }.size
            %p You got <strong>#{correct_tasks} out of #{correct_tasks + incorrect_tasks}</strong> questions right, and scored <strong>#{@current_section.points_earned(current_user)} points</strong> in this section!
            - if @achievement_tasks.count == 0 and @challenge_tasks.count > 0
              %p Continue on to the <strong>Creative Reponse</strong> tab to earn additional points and level-up.
            - if @challenge_tasks.count == 0 and @achievement_tasks.count > 0
              %p Continue on to the <strong>Tasks</strong> tab to earn additional points and level-up.
            - if @challenge_tasks.count > 0 and @achievement_tasks.count > 0
              %p Continue on to the <strong>Creative Reponse</strong> and <strong>Tasks</strong> tabs to earn additional points and level-up.          
      %div#questions_tab.tab_content{ style: "" }
        %div.editor_view{ style: "display: none; height:100%;" }
          %form{style: "width:600px; padding:0 0 0 10px; height:90%; margin-top:-10px;"}
            %fieldset{style: "display: inline-block; margin-right:28px; width:56%;"}
              %legend Create a CR
              %label What's your question?
              %textarea{class:"rows2", placeholder:"Question...", style:"width:100%;"}
              %label What type of response should people give?
              %label.radio
                %input{type:"radio", name:"optionsRadios", id:"optionsRadios1", value:"YouTube"}
                YouTube video
              %label.radio
                %input{type:"radio", name:"optionsRadios", id:"optionsRadios1", value:"Image"}
                Image upload
              %label.radio
                %input{type:"radio", name:"optionsRadios", id:"optionsRadios1", value:"Text"}
                Text response             
              %label
              %button.button.button-actionable{style: "float:right;"} Continue
            %div{style: "display:inline-block; margin-left:20px; vertical-align:top; width:200px; border-left: 1px solid #E7E7E7; position:relative; top:48px; padding-left:10px"}
              %h4 
                %img{src:"https://s3.amazonaws.com/moonlite-nsdub/static/Lightbulb+icon", style:"height:25px; width:25px;"}
                Tips:
              %ul{style:"font-size:13px;"}
                %li Questions should enable people to demonstrate their knowledge or passion for the Challenge.
                %li Keep the tone informal but direct.
                %li Make sure you check for spelling and grammar.
        %div.task_view
          - if @challenge_tasks.empty?
            %p No Challenge tasks available.
          - else
            %table
              - @challenge_tasks.each do |t|
                %tr
                  %td
                    - if t.status_id
                      %div= link_to t.question, user_path(current_user, task: t.id)
                    - else
                      %div= link_to t.question, take_section_path(@current_section, task_id: t.id)
                  %td.question_status
                    - if t.status_id
                      = link_to "Completed", user_path(current_user, task: t.id), class: "label label-success", target: "_blank"
                      %div.launchpadpoints= t.points_awarded.to_i.to_s + " points"
                    - else
                      = link_to "Incomplete", take_section_path(@current_section, task_id: t.id), class: "label label-important"
      %div#achievements_tab.tab_content{ style: "display: none;" }
        %div.editor_view{ style: "display: none;" }
          %form{style: "width:600px; padding:0 0 0 10px; height:90%; margin-top:-10px;"}
            %fieldset{style: "display: inline-block; margin-right:28px; width:99%;"}
              %legend{style:"margin-bottom:5px; "} Create a CR
              %h4{style:"margin-top:12px; font-size:14px;"} Your question:
              %div{style:"margin-left:12px;"}
                %span{style:"font-weight:bold;font-size:14px;"} Your question text goes right here
              %h4{style:"margin-top:12px; font-size:14px; "} Here's where your question will appear:
              %div{style:"margin-left:12px;"}
                %span{style:" font-size:14px;"} Challenge:
                %span{style:"font-weight:bold;font-size:14px;"} #{@current_section.path.name}
                %br/
                %span{style:" font-size:14px;"} Section: 
                %span{style:"font-weight:bold;font-size:14px;"} #{@current_section.name}
              %h4{style:"margin-top:12px; font-size:14px; margin-bottom:5px;"} Do you want to also post an answer to this question?
              %button.button{style:"float:left; margin-bottom:10px; text-shadow:none; color:#333;"}Back
              %button.button.button-actionable{style:"margin-left:12px;"}Yes!
              %button.button.button-info{style:""}Nah, just publish my question
        %div.task_view
          - if @achievement_tasks.empty?
            %p No tasks available.
          - else
            %table
              - @achievement_tasks.each do |t|
                %tr
                  %td
                    - if t.status_id
                      %div= link_to t.question, user_path(current_user, task: t.id)
                    - else
                      %div= link_to t.question, take_section_path(@current_section, task_id: t.id)
                  %td.question_status
                    - if t.status_id
                      = link_to "Completed", user_path(current_user, task: t.id), class: "label label-success", target: "_blank"
                      %br
                      %span.launchpadpoints= t.points_awarded.to_i.to_s + " points"
                    - else
                      = link_to "Incomplete", take_section_path(@current_section, task_id: t.id), class: "label label-important"
  :javascript
    var display_type = #{@display_type || 0};
    var open_tab;
    $(function(){
      if(display_type == 0){ open_tab = "#questions_tab_link"; } 
      if(display_type == 2){ open_tab = "#arena_tab_link"; } 
      if(display_type == 3){ open_tab = "#achievement_tab_link"; }
      
      $(".tab_content").hide();
      $("ul.nav-tabs li.active").removeClass("active");
      $(open_tab).parent().addClass("active");
      $($(open_tab).attr("href")).show();
    
      $(".nav-tabs li a").click(function(){
        $(".tab_content").hide();
        $("ul.nav-tabs li.active").removeClass("active");
        $(this).parent().addClass("active");
        $(".active_tab").removeClass("active_tab");
        var $open_tab = $($(this).attr("href"));
        $open_tab.addClass("active_tab");
        $open_tab.find(".task_view").show();
        $open_tab.find(".editor_view").hide();
        $open_tab.show();
      });
      
      $("#editor_link").click(function(){
        $(".active_tab").find(".task_view").hide();
        $(".active_tab").find(".editor_view").show();
      });
    });